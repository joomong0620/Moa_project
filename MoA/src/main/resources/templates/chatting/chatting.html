<!DOCTYPE html>
<html lang="ko" color-theme="light" xmlns="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
    <title>채팅방</title>


    <link rel="stylesheet" th:href="@{/css/main-style.css}">
    <link rel="stylesheet" th:href="@{/css/board/boardDetail-style.css}">
    <!--  <link rel="stylesheet" th:href="@{/css/chatting/chatting-style.css}"> -->
    <link rel="stylesheet" th:href="@{/css/chatting/chattingTheme-style.css}">


    <script src="https://kit.fontawesome.com/a2e8ca0ae3.js" crossorigin="anonymous"></script>
</head>


<body>
    <main>

        <!-- header.html 조각을 얻어와서 추가하기 -->
        <th:block th:replace="~{/common/header}">header.html</th:block> 


        <button id="addTarget">추가</button>
        <label for="changeTheme">테마변경</label>
        <input type="checkbox" id="changeTheme">


        <div id="addTargetPopupLayer" class="popup-layer-close">  
            <span id="closeBtn">&times</span>


            <div class="target-input-area">
                <input type="search" id="targetInput" placeholder="닉네임 또는 이메일을 입력하세요" autocomplete="off">
            </div>


            <ul id="resultArea">
               <!--  <li class="result-row" data-id="1">
                    <img class="result-row-img" src="/images/user.png">
                    <span> <mark>유저</mark>일</span>
                </li>
                <li class="result-row"  data-id="2">
                    <img class="result-row-img" src="/images/user.png">
                    <span><mark>유저</mark>이</span>
                </li>


                <li class="result-row">일치하는 회원이 없습니다</li> -->
            </ul>
        </div>
   
        <div class="chatting-area">
            <ul class="chatting-list">

                <th:block th:each="room : ${roomList}">

                    <li class="chatting-item" th:chat-no="${room.chattingNo}" th:target-no="${room.targetNo}">
                        <div class="item-header">

                            <img th:unless="${room.targetProfile}" class="list-profile" th:src="@{/images/user.png}">

                            <img th:if="${room.targetProfile}" class="list-profile" th:src="${room.targetProfile}">

                        </div>
                        <div class="item-body">
                            <p>
                                <span class="target-name" th:text="${room.targetNickName}">상대방 이름</span>
                                <span class="recent-send-time">[[${room.sendTime}]]</span>
                            </p>
                            <div>
                                <p class="recent-message" th:text="${room.lastMessage}">메세지 내용</p>
    
                                <p th:if="${room.notReadCount > 0}" class="not-read-count">[[${room.notReadCount}]]</p>
                            </div>
                        </div>
                    </li>
                </th:block>
            </ul>


            <div class="chatting-content">
                <ul class="display-chatting">
                    <!-- <li class="my-chat">
                        <span class="chatDate">12:11</span>
                        <p class="chat">오늘 수업 어땠어?</p>
                    </li>


                    <li class="target-chat">
                        <img src="/images/user.png">


                        <div>
                            <b>유저이</b>  <br>
                            <p class="chat">채팅 배웠는데 너무 재밌어!<br>혜선쌤 강의는 최고야! 짜릿해~</p>
                            <span class="chatDate">14:05</span>
                        </div>
                    </li> -->
                </ul>  
           
                <div class="input-area">
                    <textarea id="inputChatting" rows="3"></textarea>
                    <button id="send">보내기</button>
                </div>
            </div>
        </div>
    </main>


    <!-- footer.html 조각 얻어와 추가하기 -->
    <th:block th:replace="~{/common/footer}">footer.html</th:block>

    <!--------------------------------------- sockjs를 이용한 WebSocket 구현을 위해 라이브러리 추가 ---------------------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>

    <script th:inline="javascript">

        const loginMemberNo = /*[[${session.loginMember.memberNo}]]*/ "로그인한 회원 번호";
    </script>

    <script th:src="@{/js/chatting/chatting.js}"></script>
</body>
</html>
